import{k as S,r as c,U as i,C as g,B as m,o as n,c as u,a as e,u as v,d as h,v as F,b as _,D as x,F as p,i as U,w as N,j as b,z as V,q as A,y as B}from"./index-BCYkUbMV.js";const M=e("br",null,null,-1),D=["src"],I=e("br",null,null,-1),q=e("br",null,null,-1),E=e("label",{for:"name"},"Name: ",-1),P=e("br",null,null,-1),R=e("br",null,null,-1),T=e("label",{for:"name"},"Image: ",-1),j=e("br",null,null,-1),z=e("br",null,null,-1),L=e("b",null,"Users",-1),O=e("option",{value:""},"Select",-1),$=["value","disabled"],H=["src"],J=["onClick"],K=e("br",null,null,-1),Q=e("button",null,"Save Group",-1),Z={__name:"EditGroup",setup(W){const f=S(),d=c(),o=c(""),l=c({id:i.toNumber(f.query.id),name:"",imageUrl:"",users:[],allUsers:[]}),r=g.GetContact(null,l.value.id);w();async function y(){l.value.imageUrl=d.value.files.length?(await i.getAttachment(d)).url:null;var a=await m.SaveGroup(l.value);l.value.id=a.id,l.value.imageUrl=a.imageUrl,await g.UpdateOrCreateContact({...r,groupId:l.value.id,name:l.value.name,imageUrl:l.value.imageUrl}),B.push("/chatlist")}async function w(){if(r){var a=await m.GetGroup(r.groupId);l.value.name=r.name,l.value.imageUrl=r.imageUrl,l.value.users=a.users}l.value.allUsers=await m.GetUsers()}function C(){o.value&&(l.value.users.push(o.value),o.value="")}function k(a){l.value.users=l.value.users.filter(s=>s.id!=a)}function G(a){return l.value.users.some(s=>s.id==a)}return(a,s)=>(n(),u(p,null,[M,e("form",{onSubmit:N(y,["prevent"])},[e("img",{src:v(i).getFilePath(l.value.imageUrl),width:"100"},null,8,D),I,q,E,h(e("input",{type:"text",id:"name","onUpdate:modelValue":s[0]||(s[0]=t=>l.value.name=t)},null,512),[[F,l.value.name]]),P,R,T,e("input",{type:"file",id:"image",ref_key:"imageFile",ref:d,accept:"image/*"},null,512),j,z,e("div",null,[L,_("  "),h(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.value=t)},[O,(n(!0),u(p,null,U(l.value.allUsers,t=>(n(),u("option",{value:t,disabled:G(t.id)},b(t.name),9,$))),256))],512),[[x,o.value]]),_("  "),e("button",{type:"button",onClick:C},"Add"),(n(!0),u(p,null,U(l.value.users,t=>(n(),u("ul",null,[e("li",null,[e("img",{src:v(i).getFilePath(t.imageUrl),width:"30"},null,8,H),_(" "+b(t.name)+" ",1),t.id!=v(V).loggedUser.id?(n(),u("button",{key:0,onClick:X=>k(t.id),type:"button"},"Remove",8,J)):A("",!0)])]))),256))]),K,Q],32)],64))}};export{Z as default};
